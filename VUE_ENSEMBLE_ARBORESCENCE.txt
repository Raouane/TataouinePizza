ğŸ“ VUE D'ENSEMBLE DE L'ARBORESCENCE - TATAOUINE PIZZA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ BACKEND (server/)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

server/
â”œâ”€â”€ storage.ts                    âœ… SIMPLIFIÃ‰ (342 lignes - orchestrateur)
â”‚   â””â”€â”€ Orchestration de 9 modules de storage
â”‚
â”œâ”€â”€ storage/                      âœ… STRUCTURE MODULAIRE (10 modules)
â”‚   â”œâ”€â”€ base-storage.ts          (Classe de base + helpers)
â”‚   â”œâ”€â”€ admin-storage.ts         (Admins)
â”‚   â”œâ”€â”€ customer-storage.ts      (Clients)
â”‚   â”œâ”€â”€ restaurant-storage.ts    (Restaurants)
â”‚   â”œâ”€â”€ driver-storage.ts        (Livreurs)
â”‚   â”œâ”€â”€ pizza-storage.ts         (Pizzas)
â”‚   â”œâ”€â”€ order-storage.ts         (Commandes)
â”‚   â”œâ”€â”€ idempotency-storage.ts   (Idempotence)
â”‚   â”œâ”€â”€ telegram-storage.ts      (Telegram)
â”‚   â””â”€â”€ cash-storage.ts          (Caisse)
â”‚   â””â”€â”€ âŒ otp-storage.ts         SUPPRIMÃ‰
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ driver/                  âœ… STRUCTURE MODULAIRE (5 fichiers)
â”‚   â”‚   â”œâ”€â”€ driver-auth.routes.ts      (Login, refresh)
â”‚   â”‚   â”œâ”€â”€ driver-cash.routes.ts      (Caisse)
â”‚   â”‚   â”œâ”€â”€ driver-orders.routes.ts    (Commandes)
â”‚   â”‚   â”œâ”€â”€ driver-push.routes.ts      (Push notifications)
â”‚   â”‚   â””â”€â”€ driver-status.routes.ts    (Statut)
â”‚   â”‚
â”‚   â”œâ”€â”€ driver-dashboard.ts      âœ… SIMPLIFIÃ‰ (27 lignes - orchestrateur)
â”‚   â”œâ”€â”€ auth.ts                  âœ… NettoyÃ© (OTP supprimÃ©)
â”‚   â”œâ”€â”€ restaurant-dashboard.ts  âœ… NettoyÃ© (OTP supprimÃ©)
â”‚   â”œâ”€â”€ admin-crud.ts
â”‚   â”œâ”€â”€ public.ts
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ customer-auth-service.ts âœ… NettoyÃ© (isOtpEnabled supprimÃ©)
â”‚   â””â”€â”€ sms-service.ts           âœ… NettoyÃ© (sendOtpSms supprimÃ©)
â”‚
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ auth-helpers.ts
â”‚   â””â”€â”€ âŒ otp-login-helper.ts   SUPPRIMÃ‰
â”‚
â””â”€â”€ scripts/
    â””â”€â”€ test-complete-order-flow.ts âœ… Mis Ã  jour


ğŸ¨ FRONTEND (client/src/)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

client/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ admin/                   âœ… OrganisÃ©
â”‚   â”œâ”€â”€ menu/                    âœ… OrganisÃ©
â”‚   â”œâ”€â”€ onboarding/              âœ… OrganisÃ©
â”‚   â”œâ”€â”€ ui/                      âœ… shadcn/ui
â”‚   â”‚   â””â”€â”€ input-otp.tsx       âš ï¸ UI gÃ©nÃ©rique (OK Ã  garder)
â”‚   â”‚
â”‚   â”œâ”€â”€ restaurant-card.tsx      âœ… Badges dynamiques + compte Ã  rebours
â”‚   â””â”€â”€ pwa-install-prompt.tsx   âœ… BanniÃ¨re PWA
â”‚
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ home.tsx                 âœ… Filtrage strict + fuseau Tunisie
â”‚   â”œâ”€â”€ cart-page.tsx            âœ… OTP supprimÃ©
â”‚   â”œâ”€â”€ onboarding.tsx           âœ… OTP supprimÃ©
â”‚   â”œâ”€â”€ order-history.tsx        âœ… OTP supprimÃ©
â”‚   â””â”€â”€ order-success.tsx        âœ… BanniÃ¨re PWA (5s aprÃ¨s succÃ¨s)
â”‚
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ use-onboarding.ts        âœ… OTP supprimÃ©
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api.ts                   âœ… OTP supprimÃ©
â”‚   â”œâ”€â”€ i18n.tsx                 âœ… Traductions PWA + compte Ã  rebours
â”‚   â””â”€â”€ restaurant-status.ts     âœ… Fuseau Tunisie (UTC+1)
â”‚
â””â”€â”€ features/
    â””â”€â”€ order/                   âœ… Exemple modulaire
        â”œâ”€â”€ hooks/
        â”œâ”€â”€ components/
        â””â”€â”€ order.api.ts


ğŸ—‘ï¸ CODE MORT / FICHIERS ORPHELINS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âŒ FICHIERS SUPPRIMÃ‰S
  â€¢ server/storage/otp-storage.ts
  â€¢ server/middleware/otp-login-helper.ts

âš ï¸ RÃ‰FÃ‰RENCES RESTANTES (commentaires uniquement)
  â€¢ server/routes/auth.ts : Commentaire documentant suppression OTP
  â€¢ server/routes/driver/driver-auth.routes.ts : Commentaire documentant suppression OTP
  â€¢ server/routes/restaurant-dashboard.ts : Commentaire documentant suppression OTP
  â€¢ server/scripts/test-complete-order-flow.ts : Commentaire documentant suppression OTP

âœ… FICHIERS NETTOYÃ‰S (OTP retirÃ©)
  â€¢ server/routes/auth.ts
  â€¢ server/routes/driver/driver-auth.routes.ts
  â€¢ server/routes/restaurant-dashboard.ts
  â€¢ server/services/customer-auth-service.ts
  â€¢ server/services/sms-service.ts (sendOtpSms supprimÃ©)
  â€¢ server/storage.ts (commentaire nettoyÃ©)
  â€¢ client/src/lib/api.ts
  â€¢ client/src/pages/cart-page.tsx
  â€¢ client/src/pages/onboarding.tsx
  â€¢ client/src/pages/order-history.tsx
  â€¢ client/src/hooks/use-onboarding.ts
  â€¢ client/src/components/onboarding/step-progress.tsx


ğŸ“Š STATISTIQUES DE REFACTORING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

BACKEND
  âœ… server/storage.ts          : 342 lignes (orchestrateur lÃ©ger)
  âœ… server/storage/            : 9 modules actifs (1 supprimÃ©)
  âœ… server/routes/driver/      : 5 fichiers modulaires
  âœ… server/routes/driver-dashboard.ts : 27 lignes (orchestrateur)

FRONTEND
  âš ï¸ Structure partiellement modulaire
    âœ… features/order/          : Exemple de modularisation
    âš ï¸ pages/                   : Fichiers monolithiques
    âš ï¸ components/               : MÃ©lange (organisÃ©s + non organisÃ©s)


ğŸ” POINTS Ã€ VÃ‰RIFIER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… server/routes/driver-dashboard.ts
   âœ… DÃ©jÃ  simplifiÃ© (27 lignes - orchestrateur lÃ©ger)
   âœ… Routes driver modulaires dans server/routes/driver/
   âœ… UtilisÃ© uniquement pour l'orchestration

2. âœ… client/src/components/ui/input-otp.tsx
   âœ… Composant UI gÃ©nÃ©rique (shadcn/ui)
   âœ… Non liÃ© Ã  notre systÃ¨me OTP supprimÃ©
   âœ… Peut Ãªtre conservÃ© (composant rÃ©utilisable)

3. âœ… Code mort potentiel
   âœ… Tous les fichiers OTP supprimÃ©s
   âœ… sms-service.ts nettoyÃ© (sendOtpSms supprimÃ©)
   âœ… Seuls des commentaires documentant la suppression restent


âœ… AMÃ‰LIORATIONS RÃ‰CENTES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… Badges dynamiques : Compte Ã  rebours ouverture/fermeture
2. âœ… Fuseau horaire : Africa/Tunis (UTC+1) partout
3. âœ… Filtrage strict : Restaurants ouverts uniquement
4. âœ… BanniÃ¨re PWA : AjoutÃ©e dans order-success.tsx
5. âœ… OTP supprimÃ© : SystÃ¨me complÃ¨tement retirÃ©
6. âœ… driver-dashboard.ts : SimplifiÃ© (27 lignes)
7. âœ… sms-service.ts : sendOtpSms supprimÃ©


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ã‰tat final : âœ… PROJET PROPRE ET MODULAIRE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
